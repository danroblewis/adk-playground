id: ea6012c0
name: Iterative Writer
description: Demo of LoopAgent with author/critic workflow
app:
  id: app_ea6012c0
  name: Iterative Writer
  description: ''
  root_agent_id: agent_loop
  session_service_uri: memory://
  memory_service_uri: memory://
  artifact_service_uri: memory://
  compaction:
    enabled: false
    max_events: 100
    summarize: true
  context_cache:
    enabled: false
    ttl_seconds: 3600
  resumability:
    enabled: false
  plugins:
  - type: ReflectAndRetryToolPlugin
    name: reflect_retry
    max_retries: 3
    throw_exception_if_retry_exceeded: false
  state_keys:
  - name: story
    description: story
    type: string
    default_value: null
    scope: session
  artifacts: []
  models:
  - id: model_miw9xh0n
    name: New Model
    provider: litellm
    model_name: ollama/qwen3:8b
    api_base: http://node1:11434
    temperature: null
    max_output_tokens: null
    top_p: null
    top_k: null
    is_default: true
  default_model_id: model_miw9xh0n
agents:
- type: LlmAgent
  id: agent_writer
  name: writer
  description: Writes and refines a story iteratively
  model:
    provider: litellm
    model_name: ollama/qwen3:8b
    api_base: http://node1:11434
    fallbacks: []
    temperature: null
    max_output_tokens: null
    top_p: null
    top_k: null
  instruction: You are a creative writer.
  output_key: null
  include_contents: default
  disallow_transfer_to_parent: false
  disallow_transfer_to_peers: false
  tools: []
  sub_agents: []
  before_agent_callbacks: []
  after_agent_callbacks: []
  before_model_callbacks: []
  after_model_callbacks: []
  before_tool_callbacks: []
  after_tool_callbacks: []
- type: LoopAgent
  id: agent_loop
  name: refinement_loop
  description: Loops author/critic until satisfied
  sub_agents:
  - agent_author_critic
  max_iterations: 3
- type: LlmAgent
  id: agent_author
  name: author
  description: 'You are a creative writer tasked with crafting a concise, emotionally
    resonant story within a collaborative refinement loop. Your role is to generate
    a 2-3 sentence narrative that establishes a clear beginning, develops a relatable
    conflict or moment, and concludes with impactful imagery or emotion. Work within
    the refinement_loop system by: 1) Writing the story based on the provided topic
    and any feedback from the critic agent, 2) Ensuring your output contains only
    the story text (no explanations, metadata, or markdown), and 3) Adhering to the
    language of the input prompt. Prioritize vivid descriptions and emotional depth
    while maintaining brevity. If feedback is provided, revise the story to address
    specific suggestions before submitting.'
  model:
    provider: litellm
    model_name: ollama/qwen3:8b
    api_base: http://node1:11434
    fallbacks: []
    temperature: null
    max_output_tokens: null
    top_p: null
    top_k: null
  instruction: 'You are a creative writer tasked with crafting a concise, emotionally
    resonant story within a collaborative refinement loop. Your role is to generate
    a 2-3 sentence narrative that establishes a clear beginning, develops a relatable
    conflict or moment, and concludes with impactful imagery or emotion. Work within
    the refinement_loop system by: 1) Writing the story based on the provided topic
    and any feedback from the critic agent, 2) Ensuring your output contains only
    the story text (no explanations, metadata, or markdown), and 3) Adhering to the
    language of the input prompt. Prioritize vivid descriptions and emotional depth
    while maintaining brevity. If feedback is provided, revise the story to address
    specific suggestions before submitting.'
  output_key: story
  include_contents: default
  disallow_transfer_to_parent: false
  disallow_transfer_to_peers: false
  tools: []
  sub_agents: []
  before_agent_callbacks: []
  after_agent_callbacks: []
  before_model_callbacks: []
  after_model_callbacks: []
  before_tool_callbacks: []
  after_tool_callbacks: []
- type: LlmAgent
  id: agent_critic
  name: critic
  description: Reviews the story and decides to approve or request changes
  model:
    provider: litellm
    model_name: ollama/qwen3:8b
    api_base: http://node1:11434
    fallbacks: []
    temperature: null
    max_output_tokens: null
    top_p: null
    top_k: null
  instruction: 'You are a story critic. Review the current story from state key "story".


    If the story is good (has a clear beginning, vivid descriptions, and emotional
    impact), call exit_loop() to approve it.


    If it needs improvement, provide specific feedback that will be used to improve
    the story. Do NOT call exit_loop if improvements are needed.'
  output_key: null
  include_contents: default
  disallow_transfer_to_parent: false
  disallow_transfer_to_peers: false
  tools:
  - type: builtin
    name: exit_loop
  sub_agents: []
  before_agent_callbacks: []
  after_agent_callbacks: []
  before_model_callbacks: []
  after_model_callbacks: []
  before_tool_callbacks: []
  after_tool_callbacks: []
- type: SequentialAgent
  id: agent_author_critic
  name: author_critic_sequence
  description: Runs author then critic in sequence
  sub_agents:
  - agent_author
  - agent_critic
custom_tools: []
mcp_servers: []
